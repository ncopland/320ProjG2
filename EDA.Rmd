---
title: "EDA"
author: "Sarah Bazari"
date: "2025-07-15"
output: html_document
---

*** Questions 8 and 10 ***

```{r}
library(readr)
library(tidyverse)
data = read_csv("Police_Arrests_Clean.csv")
```

```{r}
# 10) Which zip code in Chapel Hill experiences the most arrests? And accordingly, what classifications of offenses are most common to each zip code?

# filters just for chapel hill
chapel_hill_arrests = data %>%
  filter(City == "CHAPEL HILL")
# count arrests per zipcode
zip_counts = chapel_hill_arrests %>%
  count(Zip, sort = TRUE)

zip_counts
```

```{r}
# count most common charges per zipcode
offense_by_zip = chapel_hill_arrests %>%
  count(Zip, Charge, sort = TRUE)

# see the top offenses per zip
offense_by_zip %>%
  group_by(Zip) %>%
  slice_max(n, n = 3) %>% # top 3 per zip
  arrange(Zip, desc(n))
```
```{r}
# visualiztion bar plot

ggplot(zip_counts, aes(reorder(as.character(Zip), -n), y = n)) +
  geom_col(fill = "#E63946", width = 0.7) +  # Nice deep red tone
  labs(
    title = "Number of Arrests by Zip Code in Chapel Hill",
    subtitle = "Zip codes with the highest arrest counts shown in descending order",
    x = "Zip Code",
    y = "Number of Arrests"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
    axis.text.y = element_text(size = 12),
    axis.title = element_text(face = "bold"),
    plot.margin = margin(10, 20, 10, 10)
  )
```

```{r}
# 8) How does the presence of drugs or alcohol at the time of arrest vary by gender, and which gender shows a higher proportion of substance-involved arrests?

substance_by_gender = data %>%
  filter(Gender %in% c("M", "F"),
         Drugs_Alcohol %in% c("Y", "N")) %>%
  count(Gender, Drugs_Alcohol) %>%
  group_by(Gender) %>%
  mutate(Proportion = n / sum(n)) %>%
  ungroup()

substance_by_gender
```

```{r}
# visualiztion 

ggplot(substance_by_gender, aes(x = Gender, y = Proportion, fill = Drugs_Alcohol)) +
  geom_col(position = "dodge") +
  scale_fill_manual(
    values = c("Y" = "#1b9e77", "N" = "#d95f02"),
    labels = c("Y" = "Yes", "N" = "No")
  ) +
  labs(
    title = "Proportion of Arrests Involving Drugs or Alcohol by Gender",
    subtitle = "Includes only arrests with known gender and substance info",
    x = "Gender",
    y = "Proportion of Arrests",
    fill = "Substance Present?"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    axis.text.x = element_text(face = "bold"),
    legend.position = "top",
    legend.title = element_text(face = "bold")
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))

```

