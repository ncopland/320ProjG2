---
title: "Exploratory Data Analysis"
author: "STOR 320.(01 OR 02) Group PLACE_GROUP_NUMBER_HERE (Ex: STOR 320.01 Group 12)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

# Import Data Below
# read_csv()
arrests = read.csv("C:/Users/Nicholas Copland/OneDrive - University of North Carolina at Chapel Hill/STOR_320/Final/Police_Arrests_Clean2.csv")
incidents = read.csv("Police_Incidents_Clean.csv")
```

# Creator: FIRSTNAME LASTNAME

### Q1: WRITE_QUESTION_HERE

```{r}
```

### Q2: WRITE_QUESTION_HERE

```{r}
#
```

# Interpreter: FIRSTNAME LASTNAME

### Q1: WRITE_QUESTION_HERE

```{r}
#
```

### Q2: WRITE_QUESTION_HERE

```{r}
#
```

# Orator1: Nicholas Copland

### Q1: For the UNC shooting in 2023, are there multiple incident reports on the day of the shooting that correlated with the arrest?
```{r}
Shooting_Arrest <- arrests %>%
  filter(Arrest_Date == as.Date('2023-8-28'))

#We know that the incident occurred at 1pm and the suspect was arrested at 2:40pm so any incident reports related to the incident would fall between those times
Shooting_Day <- incidents %>%
  filter(Report_Date <= ymd_hms('2023-08-28 14:40:00'), , Report_Date >= ymd_hms('2023-08-28 13:00:00'))

Shooting_Day

ggplot(data = Shooting_Arrest, mapping = aes(x = Arrest_Date)) + 
  geom_bar()
```
Update: We are no longer using the incidents data set partly because of this EDA question that revealed a few things about the nature of that data. 
  1. There are no incident reports for the date of the UNC shooting at the correct time
  2. There is no arrest report for the date of the UNC shooting
These two factors helped us to learn the incident data is a lot less comprehensive than we thought. Our theory on the shootings absence from the arrest data is that because other departments were involved CHPD didn't report it as they didn't make the arrest. It likely shows up in the Orange County system or maybe the State Trooper data. 


### Q2: How do crime patterns within Chapel Hill fluctuate in relation to the UNC academic calendar, and do certain types of crimes peak during student presence (e.g., semester sessions) or absence (e.g., breaks and holidays)?

```{r}
#Creating Two Categories: Fall Semester and Spring Semester (when most students are on campus) and Breaks (When most students are off campus)
arrests = arrests  %>%
  mutate(
    Year = year(Arrest_Date),
    Month = month(Arrest_Date),
    Day = day(Arrest_Date),
    Hour = hour(Arrest_Date)
  )

Semesters = arrests %>%
  filter(
    (Month == 1 & Day >= 7) |
    (Month %in% 2:4) |
    (Month == 5 & Day <= 10) |
    (Month == 8 & Day >= 15) |
    (Month %in% 9:11) |
    (Month == 12 & Day <= 14)
  )

Breaks = arrests %>%
  filter(
    !((Month == 1 & Day >= 7) |
    (Month %in% 2:4) |
    (Month == 5 & Day <= 10) |
    (Month == 8 & Day >= 15) |
    (Month %in% 9:11) |
    (Month == 12 & Day <= 14)))
```

```{r}
OnBreak = arrests %>%
  mutate(OnBreak = (ifelse(Object_Id %in% Breaks$Object_Id, "On Break", "Semester"))) %>%
  mutate(YearMonth = as.Date(paste(Year, Month, "01", sep = "-"))) %>%
  group_by(YearMonth, OnBreak) %>%
  summarise(Count = n(), .groups = "drop")

ggplot(OnBreak, aes(x = YearMonth, y = Count, fill = OnBreak)) +
  geom_col(position = "stack") +
  labs(
    title = "Monthly Arrest Counts: Semester vs. Break",
    x = "Month",
    y = "Number of Arrests",
    fill = "Status"
  ) +
  theme_minimal()
```

# Deliverer: FIRSTNAME LASTNAME

### Q1: WRITE_QUESTION_HERE

```{r}
#
```

### Q2: WRITE_QUESTION_HERE

```{r}
#
```

# Follow-up Questions

### New Questions Based Off Initial Investigation

- Q1: WRITE_QUESTION_HERE
- Q2: WRITE_QUESTION_HERE
- Q3: WRITE_QUESTION_HERE 
- Q4: WRITE_QUESTION_HERE

### Investigation of Follow-up Questions

GIVE WHAT 2 QUESTIONS YOU ATTEMPTED TO INVESTIGATE FURTHER IN COMPLETE SENTENCES (*Example:* Our group decided to investigate Q2 and Q4 in further detail.)

SHOW AT LEAST 2 TABLES OR FIGURES BELOW THAT EXPLORE ANSWERS FOR THE QUESTIONS YOU ARE INVESTIGATING FURTHER.

```{r}
#
```

```{r}
#
```

# Summary

GIVE A 2 PARAGRAPH SUMMARY. 

PARAGRAPH 1 SHOULD DESCRIBE WHAT YOU LEARNED ABOUT YOUR DATA FROM INVESTIGATING THE INITIAL QUESTIONS. DID YOU FIND ANYTHING UNUSUAL IN YOUR DATA? DID ANYTHING SURPRISE YOU? WHICH OF THE INITIAL QUESTIONS WERE HELPFUL IN LEADING YOU TO MORE QUESTIONS?

PARAGRAPH 2 SHOULD SUMMARIZE WHAT YOU LEARNED FROM INVESTIGATING THE FOLLOW-UP QUESTIONS. WHY ARE THESE FOLLOW-UP QUESTIONS INTERESTING FOR INVESTIGATION? DESCRIBE THE TABLES/FIGURES YOU USED TO EXPLORE ANSWERS TO THESE FOLLOW-UP QUESTIONS? WHAT DID YOU LEARN FROM THE TABLES/FIGURES REGARDING THE FOLLOW-UP QUESTIONS YOU PROPOSED?